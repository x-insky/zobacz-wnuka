$(document).ready(function(){var a="table.galeria",e="zlobek.chojnow.eu",t="zdjecia_galeria",i="http://",n="zlobek_zdj_",o=".jpg",r="./przechwytywacz.php",s="?url_zewn=",l="div#zawartosc_do_podmiany",d="div#skladowisko",c="table.galeria",p="div#galeria_spis_podmiana",u="div#galeria_spis",g=0,y=0,w=0,z=0,k=0,h=0,_=0,f=0,v=0,m=$("input#galeria_wybrany_nr"),b=$("input#suwak_galerii"),j=$("input#podstrona_wybrany_nr"),x=$("input#suwak_podstrony"),I=[],A=[],S="",C=0,P="",T="",O=0,D=0,N="",R="",X="";function Y(a,e,t,i,n,o){switch(i.length>0&&(i=" "+i),o||(o={ktoraPodstrona:1,wybranyNrGalerii:1}),n){case"galeria_podstrona":try{$(a).load(r+s+e+t+i,function(l,c,p){if(J("podstrona"),"success"===c)console.log("wykonano load("+n+") dla elementu '"+a+"' dla zapytania '"+r+s+e+t+i+"'. Docelowo ma być wyświetlona "+o.ktoraPodstrona+". podstrona galerii."),U(l)?(G(a,!0),d(),$("#nazwa_galerii").hasClass("szara_zawartosc")&&$("#nazwa_galerii").removeClass("szara_zawartosc"),W(a,o.ktoraPodstrona)):Q(p,c);else{var u=parseInt(t.substr(t.lastIndexOf(",a")+2));V({tytul:"Problem z załadowaniem galerii #"+u+"!",tresc:"Nie udało się załadować wskazanej podstrony nr <strong>"+o.ktoraPodstrona+"</strong>. dla galerii o numerze <strong>"+u+"</strong>. Spróbuj ponownie.<br />Diagnostyka: kod błędu nr "+p.status+" ("+p.statusText.toLowerCase()+') o statusie "'+c+'".'}),na("div.blad",500),ra("#galeria_paginacja_"+o.ktoraPodstrona)}"complete"===c&&alert("Test zakończenia żądania - galeria podstrona")})}catch(a){var l="BŁĄD! "+a+"/nProblem z załadowaniem podstrony galerii! Spróbuj ponownie. STATUS: "+status+", XHR: "+xhr.status+" ("+xhr.statusText+")";$("#galeria_spis").prepend('<p class="blad">'+l+"</p>"),na("p.blad",500)}break;case"spis_galerii":o.trybPowtorki||(I.push({adresPelny:r+s+e+t+i,adresZasobu:t,elementWitryny:i,tag:a}),console.info(I));try{$(a).load(r+s+e+t+i,function(l,c,f){if(J("spis"),"success"===c)U(l)?(console.log("wykonano load("+n+") dla elementu '"+a+"' dla zapytania '"+r+s+e+t+i+"'"),G(a),d(),function(){0===w&&(Z(),q());w++,z+=5,console.log("Wszystkich podstron jest "+g+", zaczytano "+y+" podstron, pozycja w galerii to "+w+", a kliknięć było "+h+".");for(var a="",e=1;e<=5;e++)a+='<div id="kontener_odnosnik_'+String(e+z)+'" class="kontener_odnosnik"><div class="tytul_odnosnik"><h3>Tytuł odnośnika nr '+String(e)+' </h3></div><div id="zdjecie_odnosnik_'+String(e+z)+'" class="zdjecie_odnosnik">Zdjęcie nr '+String(e+z)+'</div><div class="kontener_tekstowy_odnosnik"><div class="data_odnosnik">Data galerii</div><div class="opis_odnosnik">A tu nieco więcej tekstu, dokumentującego opis tej galerii '+String(e)+'. Więcej wypełniacza typu lorem ipsum...</div></div><div class="dolna_zaslonka"></div><div class="szczegoly"><p>XXXX</p><p><span>galeria</span><br />podstrona</p><p>YYY</p></div></div>';$(u).append(a);var t=$(p+" td.galeria_kolor a.link_tresc");if(t.length>0)for(var e=0;e<t.length;e++){$(t[e]).removeAttr("class").attr("data-href",$(t[e]).attr("href")).removeAttr("href");var i=$(u+" .zdjecie_odnosnik:eq("+(z+e)+")");$(i).html(t[e])}var n=$(p+" td.galeria_kolor b a.link");if(n.length>0)for(var o="",r=0,s="",e=0;e<n.length;e++)o=$(n[e]).removeAttr("class").attr("href"),o=parseInt(o.substr(o.lastIndexOf(",a")+2)),r=H(o),$(n[e]).attr("data-href",$(n[e]).attr("href")).removeAttr("href").attr("tabindex",0),i=$(u+" .szczegoly:eq("+(z+e)+")"),s="<p>"+o+"</p><p><span>galeria</span><br />podstrona</p><p>"+r+"</p>",$(i).html(s),i=$(u+" .tytul_odnosnik:eq("+(z+e)+")"),s=$(n[e]).text(),$(n[e]).removeClass("link").wrapInner("<h2></h2>"),s.length<15&&$(n[e]).find("h2").addClass("wyzszy"),s.length>=24&&s.length<35&&$(n[e]).find("h2").addClass("mniejszy"),s.length>=35&&$(n[e]).find("h2").addClass("najmniejszy"),$(i).html(n[e]);var l=$(p+" td.galeria_kolor font");if(l.length>0)for(var e=0;e<l.length;e++){i=$(u+" .data_odnosnik:eq("+(z+e)+")");var d=$(l[e]).text();d=d.replace("data publikacji: ","z dnia: "),$(i).text(d)}var c=$(p+" td blockquote div[align=justify]");if(c.length>0)for(var e=0;e<c.length;e++){i=$(u+" .opis_odnosnik:eq("+(z+e)+")");var _=$(c[e]).text();$(i).html(_)}var f=$(p+" tr:last td[colspan=2] a.link_tresc");if(f.length>=1){for(var v=0,e=0;e<f.length;e++){var m=$(f[e]).text();m.search("nowsze")>=0||m.search("starsze")>=0||v++}y=++v}$(p+" > table").remove();var b=$(u+" div.kontener_odnosnik:has(h3)");if(b.length>0)for(var e=0;e<b.length;e++)console.log("Znaleziono nadmiar w ilości "+(e+1)+" wpisu/wpisów z "+b.length+' dla obiektu o id="'+$(b[e]).attr("id")+'", który usunięto.'),$(b[e]).remove(),z--;z>=k&&$(u+" div.kontener_odnosnik:has(h3)").css({backgroundColor:"#666"})}(),function(a){for(var e=!1,t=0;t<I.length;t++)if(-1!=I[t].adresPelny.indexOf(a)){e=t;break}if(e>=0)return I.splice(e,1),e}(t),o.trybPowtorki&&(_--,function(a){if($(a).length>0){a=$(a).length>1?$(a)[0]:$(a);parseInt(a.find("strong:first-of-type > span").text());var e=0,t="";_<1&&a.slideUp(1e3,function(){$(this).remove()}),_>=1&&(a.find("strong:first-of-type > span").text(_),e=da().adresZasobu,e=parseInt(e.substr(e.lastIndexOf(",p")+2)),a.find("strong:last-of-type > span").text(e),t=a.find(".blad_tytul").text(),1==_?(t=t.substr(0,t.lastIndexOf(" x")),a.find(".blad_tytul").text(t)):(t=t.substr(0,t.lastIndexOf(" x")+2),a.find(".blad_tytul").text(t+_)),a.removeClass("animacja_zolty_blysk").css("color"),a.addClass("animacja_zolty_blysk"))}}(".blad_dolaczania"),ra("#przywroc_niewczytane"))):Q(f,c);else if(0==g&&0==y&&0==w&&0==z)V({tytul:"Problem z odczytem zawartości zdalnej!",tresc:"Wystąpił problem z odczytaniem zawartości zdalnej! Brak możliwości nawigacja po witrynie - konieczność przeładowania zawartości witryny.<br />Spróbuj za chwilę &ndash; naciśnij poniższy przycisk.",przyciskAkcjiOdswiez:!0,ikonaZamykania:!1});else{var v=parseInt(t.substr(t.lastIndexOf(",p")+2));_++,console.info("Błąd niepobrania podstrony spisu treści po raz "+_+" dla "+v+". niewczytanej podstrony.");var m="Problem z dołączeniem kolejnego spisu galerii po raz <span>"+_+"</span>! (STATUS: "+c+", XHR: "+f.status+" ("+f.statusText+"))",b="Wystąpił problem z dołączeniem kolejnego spisu galerii po raz <strong><span>"+_+"</span></strong>! Ostatni błąd to odczyt podstrony o numerze <strong><span>"+v+"</span></strong>. STATUS: "+c+", XHR: "+f.status+" ("+f.statusText+"). Naciśnij poniższy przycisk, aby ponowić próbę załadowania.",j="Błąd w pobieraniu kolejnych elementów";_>1?(j+=" x"+_,$(".blad_dolaczenia").html(m+" <button>Spróbuj ponownie</button>"),x=$(".blad_dolaczania"),A=j,S=b,$(x).length>0&&((x=$(x).length>1?$(x)[0]:$(x)).removeClass("animacja_zolty_blysk").css("color"),x.addClass("animacja_zolty_blysk"),x.find("h2.blad_tytul").html(A),x.find("div.blad_tresc p").html(S))):(V({tytul:j,tresc:b,ikonaZamykania:!1,dodatkowaKlasa:"blad_dolaczania",przyciskAkcjiDolacz:!0}),console.log("Generuję błąd dołączania po raz #"+_+" dla "+v+" niewczytanej podstrony spisu teści: "+b)),$(".blad_dolaczenia").removeClass("animacja_zolty_blysk").height(),$(".blad_dolaczenia").addClass("animacja_zolty_blysk"),na(".blad_dolaczania",500)}var x,A,S})}catch(a){l="BŁĄD! "+a+"/nProblem z dołączeniem kolejnego spisu galerii! STATUS: "+status+", XHR: "+xhr.status+" ("+xhr.statusText+")";$("#galeria_spis").prepend('<p class="blad">'+l+"</p>"),na("p.blad",500)}break;case"wybrana_galeria_rekurencja":try{$(a).load(r+s+e+t+i,function(l,d,c){if("success"===d)if(U(l)){!function(a,e){var t=$(a+" td.galeria_kolor a.link_tresc img");if(e>=0)for(var i=0;i<t.length;i++)i!=e&&($(t[i]).removeAttr("src"),console.log("Usunięto brakujący SRC w IMG #"+(i+1)+" spośród "+t.length+" obrazków galerii"))}(a,o.pozycjaWGalerii),console.log("Ładowanie przed rekurencją ("+n+") dla elementu '"+a+"' dla zapytania '"+r+s+e+t+i+"'"),$("#nazwa_galerii").hasClass("szara_zawartosc")&&$("#nazwa_galerii").removeClass("szara_zawartosc");var p=E(a,o.pozycjaWGalerii);B(p),Y(a,e,p.adres,i,"wybrana_galeria",o)}else Q(c,d);else{J("podstrona");var u="Problem z ładowaniem w tle dla generowania wybranej galerii! Nie udało się określić wstępnej lokalizacji - błąd ładowania podstrony nr <strong>"+parseInt(t.substr(t.lastIndexOf(",p")+2))+'</strong>.<br />STATUS: "'+d+'", XHR: '+c.status+" - "+c.statusText;V({tytul:"Błąd pobierania wybranej #"+o.wybranyNrGalerii+" galerii - wstępny etap!",tresc:u}),na(".blad",500),ra("#suwak_galerii_submit")}})}catch(a){l="BŁĄD! "+a+"/nProblem z ładowaniem w tle dla generowania wybranej galerii! STATUS: "+status+", XHR: "+xhr.status+" ("+xhr.statusText+")";$("#galeria_spis").prepend('<p class="blad">'+l+"</p>"),na("p.blad",500)}break;case"wybrana_galeria":try{$(a).load(r+s+t+i,function(e,o,l){if(J("podstrona"),ra("#suwak_galerii_submit"),"success"===o)U(e)?(console.log("Pierwsze ładowanie podwójnie zapętlone ("+n+") dla elementu '"+a+"' dla zapytania '"+r+s+t+i+"'"),$("#skladowisko").empty(),$("#skladowisko").show(100),G("#skladowisko_status_wybranej_galerii","przetwarzaj galerię, nie spis treści"),W("#skladowisko_status_wybranej_galerii")):Q(l,o);else{var d=parseInt(t.substr(t.lastIndexOf(",a")+2));V({tytul:"Błąd pobierania wybranej galerii #<strong>"+d+"</strong> - drugi etap!",tresc:"Problem z załadowaniem wybranej galerii o numerze <strong>"+d+'</strong>! Nie udało się pobrać docelowej lokalizacji.<br />STATUS: "'+o+'", XHR: '+l.status+" - "+l.statusText}),na(".blad",500)}})}catch(a){l="BŁĄD! "+a+"/nProblem z pobraniem wybranej galerii! Ponów próbę. STATUS: "+status+", XHR: "+xhr.status+" ("+xhr.statusText+")";$("#galeria_spis").prepend('<p class="blad">'+l+"</p>"),na("p.blad",500),alert(l)}break;case"wybrany_spis_galerii":try{$(a).load(r+s+e+t+i,function(e,l,d){if(J("wybrane_galerie_spis"),ra("#suwak_podstrony_submit"),"success"===l)U(e)?(console.log("Ładowanie ("+n+") dla wybranego "+o.wybranaPaginacja+" elementu '"+a+"' dla zapytania '"+r+s+t+i+"'"),$("div#wybrane_galerie_spis").removeClass("szara_zawartosc"),G("div#skladowisko_wybrane_galerie_spis"),function(a,e,t){var i=$(a+" td.galeria_kolor a.link_tresc img").length;if(i>0){for(var n="",o=1;o<=5;o++)n+='<div id="wybrany_kontener_odnosnik_'+String(o+z)+'" class="kontener_odnosnik"><div class="tytul_odnosnik"><h3>Tytuł odnośnika nr '+String(o)+' </h3></div><div id="zdjecie_odnosnik_'+String(o+z)+'" class="zdjecie_odnosnik">Zdjęcie nr '+String(o+z)+'</div><div class="kontener_tekstowy_odnosnik"><div class="data_odnosnik">Data galerii</div><div class="opis_odnosnik">A tu nieco więcej tekstu, dokumentującego opis tej galerii '+String(o)+'. Więcej wypełniacza typu lorem ipsum...</div></div><div class="dolna_zaslonka"></div><div class="szczegoly"><p>XXXX</p><p><span>galeria</span><br />podstrona</p><p>YYY</p></div></div>';$(e).empty(),$(e).append(n);var r=$(a+" td.galeria_kolor a.link_tresc"),s="";if(r.length>0)for(var o=0;o<i;o++)$(r[o]).removeAttr("class").attr("data-href",$(r[o]).attr("href")).removeAttr("href"),s=$(e+" .zdjecie_odnosnik:eq("+o+")"),$(s).html(r[o]);if((r=$(a+" td.galeria_kolor b a.link")).length>0)for(var l="",d="",o=0;o<i;o++){l=$(r[o]).removeAttr("class").attr("href"),l=parseInt(l.substr(l.lastIndexOf(",a")+2)),$(r[o]).attr("data-href",$(r[o]).attr("href")).removeAttr("href").attr("tabindex",0),d="<p>"+l+"</p><p><span>galeria</span><br />podstrona</p><p>"+String(parseInt(t))+"</p>",(s=$(e+" .szczegoly:eq("+o+")")).html(d),s=$(e+" .tytul_odnosnik:eq("+o+")");var c=$(r[o]).text();$(r[o]).removeClass("link").wrapInner("<h2></h2>"),c.length<15&&$(r[o]).find("h2").addClass("wyzszy"),c.length>=25&&c.length<35&&$(r[o]).find("h2").addClass("mniejszy"),c.length>=35&&$(r[o]).find("h2").addClass("najmniejszy"),$(s).html(r[o])}if((r=$(a+" td.galeria_kolor font")).length>0)for(var o=0;o<i;o++)s=$(e+" .data_odnosnik:eq("+o+")"),c=(c=$(r[o]).text()).replace("data publikacji: ","z dnia: "),$(s).text(c);if((r=$(a+" td blockquote div[align=justify]")).length>0)for(var o=0;o<i;o++)s=$(e+" .opis_odnosnik:eq("+o+")"),c=$(r[o]).text(),$(s).html(c);$(a+" tr").not(":last").remove()}var p=$(e+" div.kontener_odnosnik:has(h3)");if(p.length>0)for(var o=0;o<p.length;o++)console.log("Znaleziono nadmiar w ilości "+(o+1)+" wpisu/wpisów z "+p.length+' dla obiektu o id="'+$(p[o]).attr("id")+'", który usunięto.'),$(p[o]).remove();$(a+" tr:nth-child(4n-3)").each(function(){$(this).css({border:"1px dotted gray"})})}("div#skladowisko_wybrane_galerie_spis","div#wybrane_galerie_spis",o.wybranaPaginacja)):Q(d,l);else{var c=parseInt(t.substr(t.lastIndexOf(",p")+2));V({tytul:"Błąd pobierania wybranej #<strong>"+c+"</strong> grupy galerii!",tresc:"Problem z załadowaniem grupy galerii, wskazanej podstrony o numerze <strong>"+c+'</strong>! Ponów próbę.<br />STATUS: "'+l+'", XHR: '+d.status+" - "+d.statusText}),na(".blad",500)}})}catch(a){l="BŁĄD! "+a+"/nNie można dołączyć wybranej podstrony do spisu galerii! Powtórz działanie. STATUS: "+status+", XHR: "+xhr.status+" ("+xhr.statusText+")";$("#galeria_spis").prepend('<p class="blad">'+l+"</p>"),na("p.blad",500),alert(l)}break;default:V({tytul:"Błąd pobierania grupy galerii!",tresc:l='Wystąpił ogólny problem z żądaniem! Logowanie parametrów żądania - tag: "'+a+'", domena: "'+e+'", zasób: "'+t+'", elem: "'+i+'", działanie: "'+n+"... COŚ POSZŁO NIE TAK."}),na(".blad",500)}function d(){var a=$('img[src*="zdjecia/zlobek.gif"]');1===a.length&&(console.info('usuwanie pliku grafiki dla "zdjecia/zlobek.gif"'),a.remove())}}function W(r,s){r&&""!=r||(r="#zawartosc_do_podmiany"),(null==(s=parseInt(s))||isNaN(s))&&(s=1);var c=$("div#skladowisko"),p=$(document).height(),u=$("#wczytywanie_podstrona").height(),g=$("div#komentarz").height(),y=c.offset().top,w=$(window).height();console.log("PRZED - Dokument: "+p+"px, Okno: "+w+"px, PozycjaY #skladowiska: "+y+"px, wysokość DIV#wczytywanie: "+u+"px, wysokość DIV#komentarz: "+g),$("nav#nawigacja_galeria").empty().show(100),$("#glowna div#komentarz").hide(100),c.show(100);var z=$(r+" a.link_tresc");if(z.length>=1){$("nav#nawigacja_galeria").append('<div class="kontener"><h3>Pozostałe podstrony w tej galerii</h3></div>');for(var k="",h=0;h<z.length;h++)if(!((k=$(z[h]).text()).search("nowsze")>=0||k.search("starsze")>=0)){var _=$(z[h]).attr("href");console.log("Natrafiono na odnośnik nr "+(h+1)+" o zawartości '"+_+"'");var f=parseInt(_.substr(_.lastIndexOf(",p")+2,_.length-5)),v=$("<button></button>",{id:"galeria_paginacja_"+f,class:"przycisk_galeria",value:f,text:"Podstrona nr "+f,"data-tag":l,"data-adres_strony":e,"data-adres_galerii":_,"data-elem_zewn":a});$("nav#nawigacja_galeria > div:first").append(v)}}var m=$(r+" a:not(.link_tresc)");console.log("Znaleziono na podstronie "+m.length+" miniatur - dla zmiennej '"+l+"'"),$(d).empty(),$(d).append("<h2>Zdjęcia z bieżącej <span>"+s+".</span> podstrony galerii</h2>"),m.each(function(){var a=$(this),r=a.attr("href"),s=parseInt(r.substr(r.lastIndexOf(",z")+2,r.length-8)),l=a.find("img").removeAttr("border").attr("alt");console.log("Dla elementu <a> o HREF '"+r+"' NR_ZDJĘCIA to '"+s+"', a ALT miniatury IMG to '"+l+"'");var d=i+e+"/"+t+"/"+n+s+o;a.attr({href:d,"data-lightbox":"Galeria","data-title":l+" ("+s+o+")",alt:l,title:l}),a.siblings().remove(),c.append(a)}),p=$(document).height(),y=c.offset().top,w=$(window).height(),console.log("Wymiary PO - Dokument: "+p+"px, Okno: "+w+"px, PozycjaY #skladowiska: "+y+"px")}function Z(){if($(u).show(100),y=0,0===w){z=-5;var a=$(p+" td.galeria_kolor b a.link:first"),e=$(a).attr("href");if(0==a.length&&(""==e||null==e))return V({tytul:"Problem z odczytem zawartości zdalnej!",tresc:"Wystąpił problem z odczytaniem zawartości zdalnej. Nie udało się załadować wstepnych wartości (1)! Konieczność przeładowania zawartości witryny. <br />Naciśnij poniższy przycisk.",przyciskAkcjiOdswiez:!0}),!1;var t=e.lastIndexOf(",a");e=e.substr(t+2),k=parseInt(e);var i=$(p+" table.galeria tbody tr td a.link_tresc:last"),n=parseInt(i.text());if(isNaN(n)&&(i.remove(),i=$(p+" table.galeria tbody tr td a.link_tresc:last"),n=parseInt(i.text()),isNaN(n)||isNaN(k)))return V({tytul:"Problem z odczytem zawartości zdalnej!",tresc:"Wystąpił problem z odczytaniem zawartości zdalnej! Nie udało się załadować wstepnych wartości (2)! Konieczność przeładowania zawartości witryny. <br />Naciśnij poniższy przycisk.",przyciskAkcjiOdswiez:!0}),!1;n>0&&(g=n),console.log("PIERWSZY PRZEBIEG - wszystkich podstron jest "+g+", zaczytano "+y+" podstron, pozycja w galerii to "+w+", a kliknięć było "+h+"."),na("div#zaczytany_spis > h2",500,2),h++}$("h2#zaladuj_galerie_spis").show(),$("div#selektor").show()}function E(a,t){t=t||0;var n={},o=$(a+" td.galeria_kolor b a.link:eq("+parseInt(t)+")");return n.tytul=o.text(),n.adres=o.attr("href"),n.adres=i+e+"/"+n.adres,n.nrGalerii=parseInt(n.adres.substr(n.adres.lastIndexOf(",a")+2)),n.nrPodstronyGalerii=parseInt(L(n.nrGalerii)),n.opis=$(a+" td blockquote div[align=justify]:eq("+parseInt(t)+")").text(),o=$(a+" td.galeria_kolor a.link_tresc img:eq("+parseInt(t)+")").attr("src"),o=i+e+"/"+o,n.srcObrazka=o,o=$(a+" td.galeria_kolor font:eq("+parseInt(t)+")").text(),n.data=o.replace("data publikacji: ","z dnia: "),console.log('Przeszukując "'+a+'" natrafiono na datę publikacji "'+o+'" dla tytułu o indeksie +'+t+". ADRES_pełny: ",n.adres,", NR_galerii: ",n.nrGalerii,"NR_podstronyGalerii:  ",n.nrPodstronyGalerii),$(a+" td.galeria_kolor a.link_tresc img:eq("+parseInt(t)+")").removeAttr("src"),n}function G(a,t){var n="",o="";o=t?$(a+" a:not(.link_tresc) img"):$(a+" td.galeria_kolor a.link_tresc img");for(var r=0;r<o.length;r++)n=$(o[r]).attr("src"),n=i+e+"/"+n,n=$(o[r]).attr("src",n)}function q(){console.log("Ustalanie ZACZYTANYCH wartości pól formularza przeglądania galerii i wyboru podstron ..."),(f=k)>1&&(f=parseInt(f/2)),b.attr("max",k),b.val(f),m.val(f),(v=g)>1&&(v=parseInt(v/2)),x.attr("max",g),x.val(v),j.val(v)}function M(a,e){return a=parseInt(a),e?((void 0===a||isNaN(a))&&(a=1,j.val(a),x.val(a)),a<0&&(a=1,j.val(a),x.val(a)),a>g&&(a=g,j.val(g),x.val(g))):((void 0===a||isNaN(a))&&(a=1,m.val(a),b.val(a)),a<0&&(a=1,m.val(a),b.val(a)),a>k&&(a=k,m.val(k),b.val(k))),a}function U(a){return!(a.indexOf("!-A-W-A-R-I-A-!")>=0)}function B(a,e){var t=a.data;t="("+(t=t.slice(t.indexOf(":")+2,t.lastIndexOf(":")-3)).replace(/-/g,".")+")";var i='<div class="kontener"><h2>Galeria nr <span>'+a.nrGalerii+"</span> &ndash; <span>"+a.tytul+"</span></h2>";i+='<img src="'+a.srcObrazka+'" alt="'+a.tytul+'" />',i+='<p class="data">'+t+"</p>",i+="<p>",e&&(i+=e+"<br />"),i+=a.opis+"</p></div>",$("#nazwa_galerii").html(i),$("#nazwa_galerii").show(100)}function K(a){return(k-a)%5}function L(){return Math.floor(k/5)+Math.ceil(k%5/5)}function H(a){var e=L(),t=K(a),i=0;return k%e==0&&(i=1),e-Math.floor((a+t)/5)+i}function F(a,e){(!e||e<0)&&(e=100);var t=-1,i=-1;switch(a){case"spis":case 0:t=A[0].element,A[0].ile++,i=A[0].ile;break;case"wybrane_galerie_spis":case 1:t=A[1].element,A[1].ile++,i=A[1].ile;break;case"podstrona":case 2:t=A[2].element,A[2].ile++,i=A[2].ile}-1!=t&&i>0&&(1==i?$("#"+t).find("span").text(""):$("#"+t).find("span").text(" x "+i),$("#"+t).show(e))}function J(a,e){(!e||e<0)&&(e=100);var t=-1,i=-1;switch(a){case"spis":case 0:t=A[0].element,A[0].ile--,i=A[0].ile;break;case"wybrane_galerie_spis":case 1:t=A[1].element,A[1].ile--,i=A[1].ile;break;case"podstrona":case 2:t=A[2].element,A[2].ile--,i=A[2].ile}1==i&&$("#"+t).find("span").text(""),i>1&&$("#"+t).find("span").text(" x "+i),-1!=t&&i<=0&&$("#"+t).hide(e)}function V(a){var e="",t=$.extend({},{tytul:"Wystapił błąd ogólny!",tresc:"&lt;tu szczegóły błędu...&gt;",ikonaZamykania:!0,jednorazowy:!0,tryb:"dodawanie",nadanaKlasa:"blad",dodatkowaKlasa:"",przyciskAkcjiOdswiez:!1,trescPrzyciskuAkcjiOdswiez:"Odśwież stronę",przyciskAkcjiDolacz:!1,trescPrzyciskuAkcjiDolacz:"Powtórz działanie",animacja:!0},a);e='<div class="'+t.nadanaKlasa,t.animacja&&(e+=" animacja_zolty_blysk"),t.dodatkowaKlasa&&(e+=" "+t.dodatkowaKlasa),e+='"><h2 class="blad_tytul">'+t.tytul+'</h2><div class="blad_tresc"><div class="blad_ikona">!</div>',"zamiana"==t.tryb||(e+="<p>"+t.tresc+"</p>"),(t.przyciskAkcjiOdswiez||t.przyciskAkcjiDolacz)&&(e+="<h4>",t.przyciskAkcjiOdswiez&&(e+='<button class="odswiez_strone">'+t.trescPrzyciskuAkcjiOdswiez+"</button> "),t.przyciskAkcjiDolacz&&(e+='<button id="przywroc_niewczytane" title="Przycisk reaguje tylko podczas niesymulowanej awarii (w trybie prawidowej komunikacji). Wymuś prawidłową komunikację by kontynuować.">'+t.trescPrzyciskuAkcjiDolacz+"</button> "),e+="</h4>"),e+="</div>",t.ikonaZamykania&&(e+='<div class="krzyzyk_zamykanie" tabindex="0">&times;</div>'),e+="</div>",$("#galeria_spis").prepend(e)}function Q(a,e){V({tytul:"Problem globalny z załadowaniem treści!",tresc:"Błąd w dostępie do treści serwera macierzystego lub użyto niewłaściwego adresu. Otrzymano prawidłową odpowiedź, ale bez oczekiwanych elementów.<br />Diagnostyka: kod błędu nr "+a.status+" ("+a.statusText.toLowerCase()+') o statusie "'+e+'".'}),na("div.blad",500)}function aa(){var a=localStorage.getItem("awariaNaStale");return("<AWARIA!>"==a||"<BRAK AWARII>"==a)&&a}function ea(){localStorage.removeItem("awariaNaStale")}function ta(){$("#odpluskwiacz_ajaksowy").fadeIn(200)}function ia(){var a="/galeria,k0,p1.html",t=i+e;h>0&&(a="/galeria,k0,p"+String(h)+".html"),F("spis"),console.log("Załadowano spis treści dla "+w+'. pozycji galerii, adres z http: "'+t+'" odnośnik: "'+a+'".'),Y(p,t,a,c,"spis_galerii")}function na(a,e,t){var i;void 0===t&&(t=-10),$(a).length>0&&($(a).length>1&&(a=$(a)[0]),i=$(a).offset().top,console.log('Ustalono, że element wywołania "'+a+'" ma pozycję Y ',i," [px] (korektaY: "+t+", czasA: "+e+")"),$("html, body").animate({scrollTop:i+t+"px"},e))}function oa(a){$(a).prop("disabled",!0)}function ra(a){$(a).prop("disabled",!1)}function sa(a){var e=$(a).offset();return console.log('Element "',a,'" ma X:'+e.left,", Y:"+e.top),{left:e.left,top:e.top}}function la(a,e){var t=$(window).outerWidth(!0),i=$(window).outerHeight(!0);return e=e||"0.7",$(a+"> h1").text(t+" x "+i),$(a).hasClass("animacja_zanikanie2")||$(a).addClass("animacja_zanikanie2"),$(a).removeClass("animacja_zanikanie2").height(),$(a).addClass("animacja_zanikanie2"),t}function da(){return I.length>0&&I[I.length-1]}function ca(){for(var a=$("#plansza img.przenosny"),e=a.length,t=1110,i=-30,n=0;n<e;n++)$(a[n]).css({outlineColor:"",outlineStyle:""}),n%2?t-=80:t+=80,a[n].style.left=String(t)+"px",i+=50,a[n].style.top=String(i)+"px",a[n].style.zIndex=100+n}var pa,ua,ga;!function(){function a(){for(var a=document.querySelectorAll("img.przenosny"),e=a.length-1;e>=0;e--)a[e].style.zIndex=20}document.querySelector("#gra").addEventListener("dragstart",function(e){N=e.target,R=void 0===e.offsetX?e.layerX:e.offsetX,X=void 0===e.offsetY?e.layerY:e.offsetY;var t=sa(e.target);e.target.setAttribute("data-offset_x",e.target.style.left),e.target.setAttribute("data-offset_y",e.target.style.top),e.target.setAttribute("data-mysz_pocz_x",e.pageX),e.target.setAttribute("data-mysz_pocz_y",e.pageY),a();var i=N.style.zIndex;i>100&&i<1e3&&(N.style.zIndex=parseInt(N.style.zIndex)+100),console.log("Podczas przeciągania: g_mojX:",R," [ (e.layerX:",e.layerX,", e.offsetX:",e.offsetX,"), (g_mojY:",X," (e.layerY:",e.layerY,", e.offsetY:",e.offsetY,")], zaś globalnie to (",t.left,", ",t.top,"), MYSZ (",e.pageX,",",e.pageY," )","ELEMENT (",e.target.style.left,",",e.target.style.top," )")},!1),document.querySelector("#gra").addEventListener("dragover",function(a){return N.style.opacity=.5,N.style.outlineColor="#d00",a.preventDefault(),!1},!1),document.querySelector("#gra").addEventListener("drop",function(a){var e=sa(document.querySelector("#rysunek"));return N.style.left=a.pageX-e.left-parseInt(O)+"px",N.style.top=a.pageY-e.top-parseInt(D)+"px",N.style.outlineStyle="solid",N.style.outlineColor="#00d",N.style.opacity=1,console.log("Przeciąganie! e.pageX: ",a.pageX,", g_mojX:",R,", położenieTła.left:",e.left,", g_przesunięcieTłaX:",O,", e.pageY:",a.pageY,", g_mojY:",X,", położenieTła.top:",e.top,", g_przesunięcieTłaY:",D),console.log("Docelowy element ma mieć zatem (",N.style.left,", ",N.style.top,")."),a.preventDefault(),!1},!1),document.querySelector("#gra").addEventListener("touchstart",function(e){e.preventDefault();var t=e.target,i=e.touches[0],n=t.offsetLeft-i.pageX,o=t.offsetTop-i.pageY;a(),t.style.zIndex=200,console.log("Dotyk ekranu"),t.addEventListener("touchmove",function(){console.log("Dotyk ekranu - przeciąganie elementu");var a=i.pageX+n,e=i.pageY+o;t.style.left=a+"px",t.style.top=e+"px"},!1)},!1)}();$(window).on("resize",function(){la("#wymiary")}),$(document).on("keypress",function(a){var e=a.target.tagName.toLowerCase();console.log("KLAWISZ: ",a),console.info("Element zdarzenia to ",e);var t=a.originalEvent?a.originalEvent.keyCode:a.keyCode,i=a.originalEvent?a.originalEvent.altKey:a.altKey;39==t&&i&&a.preventDefault(),37==t&&i&&a.preventDefault(),(e.indexOf("input")<0||e.indexOf("textarea")<0)&&8==a.which&&a.preventDefault()}),$("#glowna").on("click keypress","a",function(a){1!=a.which&&13!=a.which&&32!=a.which||(1==a.which&&$(this).blur(),32==a.which&&(a.preventDefault(),$(this).click()))}),$("#odswiez").click(function(){location.reload()}),$("#poco_button").click(function(){$("#poco").toggle(200)}),$("#pomoc_button").click(function(){$("#pomoc").toggle(200)}),$("#symulancja_button").click(function(){$("#odpluskwiacz_ajaksowy").fadeToggle(200)}),$("#losuj_zakres").click(function(){k>0&&(f=Math.floor(Math.random()*k)+1,m.val(f),b.val(f))}),$("#losuj_zakres_podstrony").click(function(){g>0&&(v=Math.floor(Math.random()*g)+1,j.val(v),x.val(v))}),b.change(function(){var a=$(this).val();f=a,m.val(a)}),x.change(function(){var a=$(this).val();v=a,j.val(a)}),$("#wybrany_nr_zwieksz").click(function(){k>0&&f>0&&f<k&&(f++,m.val(f),b.val(f))}),$("#wybrany_nr_zmniejsz").click(function(){k>0&&f>1&&(f--,m.val(f),b.val(f))}),$("#wybrany_nr_podstrony_zwieksz").click(function(){g>0&&v>0&&v<g&&(v++,j.val(v),x.val(v))}),$("#wybrany_nr_podstrony_zmniejsz").click(function(){g>0&&v>1&&(v--,j.val(v),x.val(v))}),$("#galeria_wybrany_nr").blur(function(){var a=parseInt($(this).val());a=M(a),$(this).val(a),f=a,b.val(a)}),$("#podstrona_wybrany_nr").blur(function(){var a=parseInt($(this).val());a=M(a,"wybórPodstrony"),$(this).val(a),v=a,x.val(a)}),$("#suwak_galerii_submit").click(function(a){if(a.preventDefault,k>0){var t=M(m.val()),n=K(t),o=H(t),r=(L(),"/galeria,k0,p"+o+".html"),s=$("#nazwa_galerii").find("h2").text();""!=s&&(console.info('W <h2> do zabarwienia na szaro siedzi treść "'+s+'" i nie chce zmienić koloru w IE/Edge.'),$("#nazwa_galerii").addClass("szara_zawartosc")),oa(a.target),$(d).empty(),$("nav#nawigacja_galeria").empty(),F("podstrona"),na("div#glowna",500,-50),Y("div#skladowisko_status_wybranej_galerii",i+e,r,c,"wybrana_galeria_rekurencja",{pozycjaWGalerii:n,wybranyNrGalerii:t})}return!1}),$("#suwak_podstrony_submit").click(function(a){if(a.preventDefault,g>0){var t=M(j.val(),"naRzeczPaginacjiSpisuGalerii"),n="/galeria,k0,p"+t+".html";""!=$("#wybrane_galerie_spis").find("span:first").text()&&$("#wybrane_galerie_spis").addClass("szara_zawartosc"),oa(a.target),Y("div#skladowisko_wybrane_galerie_spis",i+e,n,c,"wybrany_spis_galerii",{wybranaPaginacja:t}),$("div#wybrany_zaczytany_spis h2 span").text(t.toString()+"."),$("div#wybrany_zaczytany_spis").show(100),F("wybrane_galerie_spis"),na("div#wybrany_zaczytany_spis",500,-50)}return!1}),$("h2#selektor_naglowek").on("click keypress",function(a){1!=a.which&&13!=a.which&&32!=a.which||(1==a.which&&$(this).blur(),32==a.which&&a.preventDefault(),$(this).hasClass("rozwiniety")?$(this).removeClass("rozwiniety").next("div").hide(100):$(this).addClass("rozwiniety").next("div").show(100))}),$("#testowy_adres_button").click(function(){$("#http_adres").val("http://zlobek.chojnow.eu/30-u_misiow,z1058,p1.html")}),$("#nawigacja_galeria").on("click",".przycisk_galeria",function(a){var e=$(this),t=i+e.attr("data-adres_strony")+"/",n=e.attr("value");F("podstrona"),console.log("Naciśnięto wywołanie "+n+". podstrony danej galerii"),Y(e.attr("data-tag"),t,e.attr("data-adres_galerii"),e.attr("data-elem_zewn"),"galeria_podstrona",{ktoraPodstrona:n}),oa(a.target)}),$("#spis_sterowanie").on("click keypress","#zaladuj_galerie_spis",function(a){console.info("DEBUG: przycisk naciśnieto już "+h+" razy, a paginacji odczytano wcześniej "+y),1!=a.which&&13!=a.which&&32!=a.which||(1==a.which&&$(this).blur(),32==a.which&&a.preventDefault(),++h<y+1&&w<=y&&(console.log("Na "+h+" żądanie zaczytano kolejną podstronę w galerii "+w+" z "+y+" podstron."),ia()))}),$("#galeria_spis, #wybrane_galerie_spis").on("click keydown","a",function(t){if(1==t.which||13==t.which||32==t.which){1==t.which&&$(this).blur(),t.preventDefault();var n=$(this),o=n.attr("data-href"),r=parseInt(o.substr(o.lastIndexOf(",a")+2)),s=parseInt(L()),d=n.text(),c=n.parents(".kontener_odnosnik").find(".opis_odnosnik").html(),p=n.parents(".kontener_odnosnik").find(".data_odnosnik").text(),u=n.parent().siblings("div.zdjecie_odnosnik").find("a img").attr("src");0==d.length&&(d=n.parent().siblings("div.tytul_odnosnik").find("a h2").html(),o=n.attr("data-href"),u=n.find("img").attr("src")),console.log('ZDARZENIE: "Naciśnięto" i wywołano odnośnik dla galerii "'+d+'"'),B({tytul:d,opis:c,srcObrazka:u,data:p,nrGalerii:r,nrPodstronyGalerii:s}),F("podstrona"),$("nav#nawigacja_galeria").empty(),$("div#skladowisko").empty(),Y(l,i+e+"/",o,a,"galeria_podstrona"),na("div#glowna",700,-6)}}),$("#http_adres_submit").click(function(){var t=$("#http_adres").val();if(String.prototype.stripHTML=function(){return this.replace(/<(?:.|\s)*?>/g,"")},-1==(t=t.stripHTML()).indexOf(e))return"",$("#form_error").slideDown(500),!1;var n=i+e+"/";$("#form_error").slideUp(200);var o=t.substr(n.lastIndexOf("/")+1);return $("#http_adres").val(n+o),$("#http_adres").prop("disabled",!0),$("#http_adres_submit").prop("disabled",!0),$("#testowy_adres_button").prop("disabled",!0),F("podstrona"),console.log("ADRES_STRONY: "+e+", ADRES_GALERII: "+o+", ZNACZNIK_ZEWN: "+a+"\nRAZEM: "+e+o+" | "+a),Y(l,i+e+"/",o,a,"galeria_podstrona"),!1}),$("#banner").hover(function(){$(this).find("#slonce_logo").addClass("animacja_slonca")},function(){$(this).find("#slonce_logo").removeClass("animacja_slonca")}),$("#galeria_spis").on("click",".odswiez_strone",function(){location.reload()}),$("#galeria_spis").on("click","#przywroc_niewczytane",function(a){if(I.length>0&&("<BRAK AWARII>"==aa()&&$(".status_ajaksa").hasClass("status_norma")||$(".status_ajaksa").hasClass("status_norma"))&&"./przechwytywacz.php"==r&&"?url_zewn="==s){var t=da();oa(a.target),F("spis"),na("#wczytywanie_spis",500),Y(t.tag,i+e,t.adresZasobu,t.elementWitryny,"spis_galerii",{trybPowtorki:!0}),console.log('NAPRAWA BŁĘDU DLA podstrony: "'+t.adresZasobu+'"')}}),$("#galeria_spis").on("click keydown",".krzyzyk_zamykanie",function(a){var e=$(this);1!=a.which&&13!=a.which&&32!=a.which||(32==a.which&&a.preventDefault(),$(this).blur(),e.parent(".blad").slideUp(1e3,function(){$(this).remove()}))}),$("#debugger_zamykanie").on("click keydown",function(a){1!=a.which&&13!=a.which&&32!=a.which||$("#odpluskwiacz_ajaksowy").fadeOut(200)}),$("div#zagraj").click(function(){$("div#gra").show(300),na("div#gra",500,10),ca()}),$("#gra_start").click(function(){ca()}),function(){$("#witryna").removeClass("brak_js");var a=$("#slonce_logo");a.removeClass("startowe_przesuniecie"),a.not(":hover")&&a.removeClass("animacja_slonca"),$("#wymiary").css("visibility","visible")}(),pa=20,(pa=parseInt(pa)||5)<5&&(pa=5),$("#naglowek .powiadamiacz").css("visibility","visible"),$("#naglowek .pasek").each(function(){dodatkowe_sekundy=Math.floor(Math.random()*pa)/(2+Math.floor(pa%5)),pa-=dodatkowe_sekundy;var a=this;$(this).css({"transition-duration":pa+"s",width:0}),setTimeout(function(){$(a).parent("div").slideUp(1e3,function(){$(this).remove()})},1010*pa)}),A=[{element:"wczytywanie_spis",ile:0},{element:"wczytywanie_wybrane_galerie_spis",ile:0},{element:"wczytywanie_podstrona",ile:0}],function(a,e){function t(){r="./przechwytywacz.php",s="?url_zewn=",$(".status_ajaksa").removeClass("status_awaria").addClass("status_norma")}function i(){r="./przepuszczacz.php",s="?url_dupa=",$(".status_ajaksa").removeClass("status_norma").addClass("status_awaria")}$(".zepsuj").click(function(){i(),1==$("#awaria_na_stale:checked").length?localStorage.setItem("awariaNaStale","<AWARIA!>"):ea()}),$(".napraw").click(function(){t(),1==$("#awaria_na_stale:checked").length?localStorage.setItem("awariaNaStale","<BRAK AWARII>"):ea()}),t(),"<AWARIA!>"==localStorage.getItem("awariaNaStale")&&$("#awaria_na_stale").prop("checked",!0),"<AWARIA!>"!=localStorage.getItem("awariaNaStale")&&"ZEPSUJ!"!=a||i(),("localhost"==window.location.host||e)&&ta()}(),function(){$("a[href*=000webhost]").parent("div").remove();var a=$("center");a&&(a.parent().prev().remove(),a.parent().remove()),(a=$("img[usemap]"))&&a.parent().remove()}(),f=Math.floor(100*Math.random())+1,console.log("Ustalanie POCZĄTKOWYCH (np. "+f+") wartości pól formularza przeglądania galerii..."),m.val(f),b.val(f),b.attr("max",105),v=Math.floor(5*Math.random())+1,console.log("Ustalanie POCZĄTKOWYCH (np. "+v+") wartości pól formularza przeglądania podstronami galerii..."),j.val(v),x.val(v),x.attr("max",6),ia(),ua||(ua=1),ga=Math.floor(Math.random()*ua),console.log("Wylosowano nr planszy: ",ga),function(a){switch(a||(a=0),a){case 0:S="./grafiki/gra/autobus/autobus.png";var e=new Image;e.src=S,e.onload=function(){var a=e.height,t=e.width;O=String(($("#rysunek").width()-t)/2)+"px",D=String(($("#rysunek").height()-a)/2)+"px",$("div#rysunek").css({backgroundImage:"url("+S+")",backgroundRepeat:"no-repeat",backgroundPosition:O+" "+D});var i="<p>Grafika '"+e.src+"' ma szerokość "+t+" i wysokość "+a+"<br />Przesunięcie wyśrodkowania to ("+O+", "+D+").</p>";$("#dolny_zasobnik").append(i)}}}(ga),function(a){"Autobus",P="./grafiki/gra/autobus/",C=10,T="cz_";for(var e,t=1110,i=-30,n=1;n<=C;n++){e=n<10?String("0"+n):String(n);var o=new Image;o.src=P+T+e+".png",o.alt=e,o.classList.add("przenosny"),n%2?t+=80:t-=80,o.style.left=String(t)+"px",i+=50,o.style.top=String(i)+"px",o.style.zIndex=100+n,o.setAttribute("data-zindex",o.style.zIndex),o.setAttribute("draggable",!0),$("#plansza").append(o)}}(),function(a,e,t,i){a=a||$("#adres_email"),t=t||"kontakt";var n="mailto:"+(e=e||"zobaczwnuka"+String.fromCharCode(64)+"email.com");$(a).text(t).attr("href",n)}(),$("#napisy h1").fitText(.9,{minFontSize:"15px",maxFontSize:"62px"}),$("#napisy h2").fitText(1.6,{minFontSize:"8px",maxFontSize:"23px"}),$("#napis_spod h3").fitText(3,{minFontSize:"7px",maxFontSize:"17px"}),la("#wymiary")});